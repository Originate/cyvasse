= content_for :navigation do
  = render 'shared/navigation', back: {name: 'Variants', href: :variants}

%section.centered.variant
  .top-section
    .title= @variant
    .rating{ 'data-score' => @variant.average_rating }
    .link= link_to 'Reviews', @variant.review_topic

    .description
      Have an idea for a new rule you want supported? Think a rule needs to be changed? Please post
      = succeed '.' do
        = link_to 'here', Discussion.find_by(title: 'Invariants and Rule Support')

  .sub-section
    .title
      Options
      - if signed_in? && current_user.can_manage?(@variant)
        = link_to 'Edit', [:edit, @variant]

    = @variant.board_description
    = link_to 'Preview', "#", { "data-action" => "preview", "data-id" => @variant.id }

  .sub-section
    .title
      Piece Rules
      - if signed_in? && current_user.can_manage?(@variant)
        = link_to 'New', [:new, @variant, :piece_rule]


    = render partial: 'piece_rules/index', locals: { variant: @variant }

  .sub-section
    .title
      Terrain Rules
      - if signed_in? && current_user.can_manage?(@variant)
        = link_to 'New', [:new, @variant, :terrain_rule]

    = render partial: 'terrain_rules/index', locals: { variant: @variant }

= content_for :modal do
  .modal#preview
    .modal-dialog
      .modal-content
        .modal-header
          %button.close(type='button' data-dismiss='modal') Ã—
          .title Preview
        .modal-body
          .board

:javascript
  $(function() {
    PieceType = require('piece_type');
    PieceType.set_data(#{ActiveSupport::JSON.encode(PieceType.urls)});

    TerrainType = require('terrain_type');
    TerrainType.set_data(#{ActiveSupport::JSON.encode(TerrainType.urls)});

    $('.rating').raty({readOnly: true})
  });
