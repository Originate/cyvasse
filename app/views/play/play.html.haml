%section.play
  .board

  .control
    .game
      .actions
        %button(data-action='setup_complete') Setup Complete
        %button(data-action='abort') Abort
        %button(data-action='resign') Resign
      .state
      .chat
      = text_field_tag 'message', '', autocomplete: 'off'

    .challenges
      .new
        .title New Challenge
        %form
          %ul
            %li
              = label_tag 'variant_id', 'Variant:'
              = select_tag 'variant_id', options_from_collection_for_select(Variant.all, :id, :to_s)
            %li
              = label_tag 'play_as', 'I Play As:'
              = select_tag 'play_as', options_for_select(['alabaster', 'onyx', 'random'].map{ |x| [x.capitalize, x] })
            %li
              = submit_tag 'Create', 'data-action' => 'create'

      .index
        .title Challenges
        %table
          %tbody.your
            %tr
              %th{colspan: 3} Your Challenges
          %tbody.open
            %tr
              %th{colspan: 3} Open Challenges

= content_for :modal do
  .modal.review
    .modal-dialog
      .modal-content
        .modal-body
          %button.close(data-dismiss="modal") Ã—
          .message
          .review
            .instructions
              Please review the variant you just played.
              %br
              Feel free to play more before reviewing if you prefer.
              %br
              You can also update your review after playing more.
            .variant
              Cyvasse by admin
            %form
              %fieldset.inputs
                %ol
                  %li.input
                    = label_tag 'rating', 'Rating', class: 'label'
                    .rating
                    = hidden_field_tag 'rating'
                  %li.input
                    = label_tag 'comment', 'Review', class: 'label'
                    = text_area_tag 'comment'
              %fieldset.actions
                %ol
                  %li.action
                    %button(data-action='submit') Submit

:javascript
  $(function() {
    ChallengesController = require('controllers/challenges_controller')
    new ChallengesController(#{current_user.id}, '#{current_user.username}').activate()

    PieceType = require('piece_type')
    PieceType.set_data(#{ActiveSupport::JSON.encode(PieceType.urls)})

    TerrainType = require('terrain_type')
    TerrainType.set_data(#{ActiveSupport::JSON.encode(TerrainType.urls)})
  });
