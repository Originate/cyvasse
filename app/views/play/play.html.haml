= render partial: 'shared/preview_modal'
= render partial: 'play/review_modal'

%section.play
  .challenges
    .new
      .title New Challenge
      %form
        %ul
          %li
            = label_tag 'variant_id', 'Variant:'
            = select_tag 'variant_id', options_from_collection_for_select(Variant.all, :id, :to_s)
          %li
            = label_tag 'play_as', 'I Play As:'
            = select_tag 'play_as', options_for_select(['alabaster', 'onyx', 'random'].map{ |x| [x.capitalize, x] })
          %li
            = submit_tag 'Create', 'data-action' => 'create'

    .index
      .title Challenges
      %table
        %tbody.your
          %tr
            %th{colspan: 3} Your Challenges
        %tbody.open
          %tr
            %th{colspan: 3} Open Challenges

  .game
    .board-wrapper
      .status
      .top-player
      .board
      .bottom-player

    .aside
      %ul.nav.nav-tabs
        %li.active
          %a(data-toggle="tab" href="#game") Game
        %li
          %a(data-toggle="tab" href="#rules") Rules

      .tab-content
        .tab-pane.active#game
          .help
          .chat
            .messages
            = text_field_tag 'message', '', autocomplete: 'off'
        .tab-pane#rules

:javascript
  $(function() {
    ChallengesController = require('controllers/challenges_controller')
    new ChallengesController(#{current_user.id}, '#{current_user.username}').activate()

    PieceType = require('piece_type')
    PieceType.set_data(#{ActiveSupport::JSON.encode(PieceType.urls)})

    TerrainType = require('terrain_type')
    TerrainType.set_data(#{ActiveSupport::JSON.encode(TerrainType.urls)})
  });
