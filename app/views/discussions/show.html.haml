= content_for :navigation do
  = render 'shared/navigation', back: {name: 'Back', href: 'javascript:history.back()'}

%section.discussion
  .title Current Topics in #{@discussion.title}
  .description= @discussion.description

  - if signed_in? && current_user.can_create?(Topic)
    = link_to 'New Topic', [:new, @discussion, :topic]

  %table
    %tbody
    - @discussion.topics.each do |topic|
      %tr{onclick: "window.location='#{topic_path(topic)}';"}
        %td
          = topic.title

          .stats
            .stat
              = topic.comments.count
              Comments

        - if signed_in? && current_user.can_manage?(topic)
          %td
            = link_to 'Edit', [:edit, topic]
            = link_to 'Destroy', topic, method: :delete, data: { confirm: 'Are you sure?' }
